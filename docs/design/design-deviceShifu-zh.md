# deviceShifu 高层设计

***deviceShifu*** 是 ***Shifu*** 用户所写的应用于 ***Shifu*** 本身交互的唯一入口。所以 ***Shifu*** 用户绝大多数时间只需要和 ***deviceShifu*** 交互即可，也是 ***Shifu*** 用户最需要了解的 ***Shifu*** 组件。***deviceShifu*** 是IoT设备在 ***Shifu*** 中的结构性数字孪生，以微服务的形式存在。其底层是Kubernetes的Pod。

## 设计目标和非目标

### 设计目标

#### 低资源消耗

因为 ***Shifu*** 本质上就是由若干个 ***deviceShifu*** 组成的，所以在一个有上千种设备的复杂场景里， ***Shifu*** 里面也会有上千个 ***deviceShifu***。所以，***deviceShifu***的资源消耗一定要非常低。

#### 无状态

***deviceShifu*** 会缓存一部分来自于设备与应用的数据，但持久化存储应储存在独立的数据库中。

#### 多态

***deviceShifu*** 需要能够成为任意设备的数字孪生。但是物联网设备太多太杂了，我们怎么才能把这么多非标准化的设备虚拟化成标准的 ***deviceShifu***呢？这就需要多态的设计了。而多态的底层实现则依赖于完全模块化的设计。我们在下面会有更具体的架构设计讲解。

#### 跨平台

***deviceShifu*** 可以运行在所有主要平台上，包括但不限于 x86/64, ARM64 等。

### 设计非目标

#### 高并发

因为高并发的流量会经过设备与 ***deviceShifu*** 之间的broker，所以 ***deviceShifu*** 本身并不需要处理高并发的情况。